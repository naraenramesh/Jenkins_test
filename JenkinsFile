pipeline {
 agent any

environment{

             PATH="$HOME/.yarn/bin:$HOME/.config/yarn/global/node_modules/.bin:$PATH"
}
 stages{

  stage('Install Dependencies'){
    steps{
         sh '''
          if ! command -v yarn &> /dev/null
                    then
                        echo "Yarn not found. Installing Yarn..."
                        curl -o- -L https://yarnpkg.com/install.sh | bash
                    else
                        echo "Yarn is already installed"
                    fi

                    # Verify Yarn version
                    yarn --version
                    '''
            echo "Yarn installed"
            sh 'yarn'
            echo "Node modules created"
  }
  }
  stage('Run Tests'){
    steps{
    sh "yarn test"
    echo "Test results"
    }
  }
 }
}
